\chapter{Modeling time, rhythm and meter}

\begin{comment}
<abjad>[hide=true]
import consort
</abjad>
\end{comment}

Timespans provide a coarse model of musical time, both in and outside of score
hierarchy.

Notated rhythm provides a fine model of musical time, from within score
hierarchy.

Meter coordinates time and rhythm vertical across score hierarchy.

\section{timespans and timespan inventories}

\subsection{anatomy of a timespan}

- offsets and duration

- wellformedness

- annotated timespans

\subsection{time relations}

- time relations: intersection, congruency etc.

\subsection{aggregate operations}

- unioning, differencing and splitting

- partitioning

- multiplexing and demultiplexing

- resolution

- timespan collection vs timespan inventory

\section{rhythm makers}

\subsection{a factory for rhythmic material}

- divisions

\begin{comment}
<abjad>
divisions = [(3, 8), (4, 8), (3, 16), (4, 16), (5, 8), (2, 4)]
</abjad>
\end{comment}

%%% ABJADBOOK START %%%
\begin{singlespacing}
\begin{lstlisting}
>>> divisions = [(3, 8), (4, 8), (3, 16), (4, 16), (5, 8), (2, 4)]
\end{lstlisting}
\end{singlespacing}
%%% ABJADBOOK END %%%

- rhythm maker

\subsection{configuration}

- specifiers: tie, duration spelling, beam

\subsection{examples}

- specific rhythm makers

- NoteRhythmMaker

\begin{comment}
<abjad>
note_rhythm_maker = rhythmmakertools.NoteRhythmMaker(
    )
show(note_rhythm_maker, divisions=divisions)
</abjad>
\end{comment}

%%% ABJADBOOK START %%%
\begin{singlespacing}
\begin{lstlisting}
>>> note_rhythm_maker = rhythmmakertools.NoteRhythmMaker(
...     )
>>> show(note_rhythm_maker, divisions=divisions)
\end{lstlisting}
\includegraphics{assets/lilypond-d0f66021e4860194d32ee0fa226ed174.pdf}
\end{singlespacing}
%%% ABJADBOOK END %%%

- EvenDivisionsRhythmMaker

\begin{comment}
<abjad>
even_division_rhythm_maker = rhythmmakertools.EvenDivisionRhythmMaker(
    denominators=[8, 16, 4],
    )
show(even_division_rhythm_maker, divisions=divisions)
</abjad>
\end{comment}

%%% ABJADBOOK START %%%
\begin{singlespacing}
\begin{lstlisting}
>>> even_division_rhythm_maker = rhythmmakertools.EvenDivisionRhythmMaker(
...     denominators=[8, 16, 4],
...     )
>>> show(even_division_rhythm_maker, divisions=divisions)
\end{lstlisting}
\includegraphics{assets/lilypond-06c5f723997363adb1e3e9391d01892a.pdf}
\end{singlespacing}
%%% ABJADBOOK END %%%

- IncisedRhythmMaker

\begin{comment}
<abjad>
incised_rhythm_maker = rhythmmakertools.IncisedRhythmMaker(
    incise_specifier=rhythmmakertools.InciseSpecifier(
        prefix_counts=[0],
        suffix_talea=[-1],
        suffix_counts=[1],
        talea_denominator=16,
        ),
    )
show(incised_rhythm_maker, divisions=divisions)
</abjad>
\end{comment}

%%% ABJADBOOK START %%%
\begin{singlespacing}
\begin{lstlisting}
>>> incised_rhythm_maker = rhythmmakertools.IncisedRhythmMaker(
...     incise_specifier=rhythmmakertools.InciseSpecifier(
...         prefix_counts=[0],
...         suffix_talea=[-1],
...         suffix_counts=[1],
...         talea_denominator=16,
...         ),
...     )
>>> show(incised_rhythm_maker, divisions=divisions)
\end{lstlisting}
\includegraphics{assets/lilypond-f21215b14c3e76d687060a020bdca52a.pdf}
\end{singlespacing}
%%% ABJADBOOK END %%%

- TaleaRhythmMaker

\begin{comment}
<abjad>
talea_rhythm_maker = rhythmmakertools.TaleaRhythmMaker(
    talea=rhythmmakertools.Talea(
        counts=[1, 2, 3, 4],
        denominator=16,
        ),
    )
show(talea_rhythm_maker, divisions=divisions)
</abjad>
\end{comment}

%%% ABJADBOOK START %%%
\begin{singlespacing}
\begin{lstlisting}
>>> talea_rhythm_maker = rhythmmakertools.TaleaRhythmMaker(
...     talea=rhythmmakertools.Talea(
...         counts=[1, 2, 3, 4],
...         denominator=16,
...         ),
...     )
>>> show(talea_rhythm_maker, divisions=divisions)
\end{lstlisting}
\includegraphics{assets/lilypond-101e0079ec09025cbd79b4f02fb37c60.pdf}
\end{singlespacing}
%%% ABJADBOOK END %%%

\subsection{composite rhythm maker}

\begin{comment}
<abjad>
composite_rhythm_maker = consort.CompositeRhythmMaker(
    default=note_rhythm_maker,
    last=incised_rhythm_maker,
    first=even_division_rhythm_maker,
    )
</abjad>
\end{comment}

%%% ABJADBOOK START %%%
\begin{singlespacing}
\begin{lstlisting}
>>> composite_rhythm_maker = consort.CompositeRhythmMaker(
...     default=note_rhythm_maker,
...     last=incised_rhythm_maker,
...     first=even_division_rhythm_maker,
...     )
\end{lstlisting}
\end{singlespacing}
%%% ABJADBOOK END %%%

\section{meter finding and rewriting}

\subsection{describing meter}

- meters vs time signatures

- rhythm trees

\subsection{finding meters}

- metric accent kernels

- offset counters

- discard final silence

\subsection{rewriting meters}

- specific iteration techniques

- boundary depth

- dot count

\section{performed and silent timespans}

\begin{comment}
<abjad>
performed_timespan = consort.PerformedTimespan(
    layer=1,
    minimum_duration=Duration(1, 8),
    music_specifier=consort.MusicSpecifier(),
    start_offset=Offset(1, 4),
    stop_offset=Offset(2, 1),
    voice_name='Violin 1 LH Voice',
    )
</abjad>
\end{comment}

%%% ABJADBOOK START %%%
\begin{singlespacing}
\begin{lstlisting}
>>> performed_timespan = consort.PerformedTimespan(
...     layer=1,
...     minimum_duration=Duration(1, 8),
...     music_specifier=consort.MusicSpecifier(),
...     start_offset=Offset(1, 4),
...     stop_offset=Offset(2, 1),
...     voice_name='Violin 1 LH Voice',
...     )
\end{lstlisting}
\end{singlespacing}
%%% ABJADBOOK END %%%

\begin{comment}
<abjad>
silent_timespan = consort.SilentTimespan(
    layer=2,
    start_offset=Offset(0, 1),
    stop_offset=Offset(1, 4),
    voice_name='Violin 1 LH Voice',
    )
</abjad>
\end{comment}

%%% ABJADBOOK START %%%
\begin{singlespacing}
\begin{lstlisting}
>>> silent_timespan = consort.SilentTimespan(
...     layer=2,
...     start_offset=Offset(0, 1),
...     stop_offset=Offset(1, 4),
...     voice_name='Violin 1 LH Voice',
...     )
\end{lstlisting}
\end{singlespacing}
%%% ABJADBOOK END %%%

\subsection{payloaded timespans}

- layer

- voice name

\subsection{performed timespans}

- forbid fusing

- forbid splitting

- minimum duration

- (additionally, music specifier: minimum phrase duration)

- divisions

- music

- music specifier

\section{timespan makers}

- timespan specifier

- independent vs dependent

- target timespans

- talea

- padding

\subsection{flooded timespan maker}

\begin{comment}
<abjad>
flooded_timespan_maker = consort.FloodedTimespanMaker()
print(format(flooded_timespan_maker))
</abjad>
\end{comment}

%%% ABJADBOOK START %%%
\begin{singlespacing}
\begin{lstlisting}
>>> flooded_timespan_maker = consort.FloodedTimespanMaker()
>>> print(format(flooded_timespan_maker))
consort.tools.FloodedTimespanMaker()
\end{lstlisting}
\end{singlespacing}
%%% ABJADBOOK END %%%

\subsection{talea timespan maker}

\begin{comment}
<abjad>
timespan_maker = consort.TaleaTimespanMaker(
    initial_silence_talea=rhythmmakertools.Talea(
        counts=(0, 4),
        denominator=16,
        )
    )
</abjad>

%%% ABJADBOOK START %%%
\begin{singlespacing}
\begin{lstlisting}
>>> timespan_maker = consort.TaleaTimespanMaker(
...     initial_silence_talea=rhythmmakertools.Talea(
...         counts=(0, 4),
...         denominator=16,
...         )
...     )
\end{lstlisting}
\end{singlespacing}
%%% ABJADBOOK END %%%

- taleas: playing, silence and initial silence

- groupings

- synchronization

- repeat and reflect

\subsection{dependent timespan maker}

\begin{comment}
<abjad>
dependent_timespan_maker = consort.DependentTimespanMaker(
    include_inner_starts=True,
    include_inner_stops=False,
    voice_names=(
        'Piano Upper Voice',
        'Piano Lower Voice',
        )
    )
</abjad>
\end{comment}

%%% ABJADBOOK START %%%
\begin{singlespacing}
\begin{lstlisting}
>>> dependent_timespan_maker = consort.DependentTimespanMaker(
...     include_inner_starts=True,
...     include_inner_stops=False,
...     voice_names=(
...         'Piano Upper Voice',
...         'Piano Lower Voice',
...         )
...     )
\end{lstlisting}
\end{singlespacing}
%%% ABJADBOOK END %%%